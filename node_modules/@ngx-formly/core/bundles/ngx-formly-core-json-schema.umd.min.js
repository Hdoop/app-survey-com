!function(e,r){"object"==typeof exports&&"undefined"!=typeof module?r(exports,require("@angular/core"),require("@ngx-formly/core")):"function"==typeof define&&define.amd?define("@ngx-formly/core/json-schema",["exports","@angular/core","@ngx-formly/core"],r):r((e["ngx-formly"]=e["ngx-formly"]||{},e["ngx-formly"].core=e["ngx-formly"].core||{},e["ngx-formly"].core["json-schema"]={}),e.ng.core,e["ngx-formly"].core)}(this,function(e,r,l){"use strict";var s=function(){return(s=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++)for(var i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i]);return e}).apply(this,arguments)};function f(e,r){var t="function"==typeof Symbol&&e[Symbol.iterator];if(!t)return e;var n,i,o=t.call(e),a=[];try{for(;(void 0===r||0<r--)&&!(n=o.next()).done;)a.push(n.value)}catch(u){i={error:u}}finally{try{n&&!n.done&&(t=o["return"])&&t.call(o)}finally{if(i)throw i.error}}return a}function m(e){return""===e||e===undefined||null===e}var t=function(){function e(){}return e.prototype.toFieldConfig=function(e,r){return this._toFieldConfig(e,s({schema:e},r||{}))},e.prototype._toFieldConfig=function(r,n){var i=this;r.$ref&&(r=this.resolveDefinition(r,n)),r.allOf&&(r=this.resolveAllOf(r,n));var o={type:this.guessType(r),defaultValue:r["default"],templateOptions:{label:r.title,readonly:r.readOnly,description:r.description}};switch(o.type){case"null":this.addValidator(o,"null",function(e){return null===e.value});break;case"number":case"integer":o.parsers=[function(e){return m(e)?null:Number(e)}],r.hasOwnProperty("minimum")&&(o.templateOptions.min=r.minimum),r.hasOwnProperty("maximum")&&(o.templateOptions.max=r.maximum),r.hasOwnProperty("exclusiveMinimum")&&(o.templateOptions.exclusiveMinimum=r.exclusiveMinimum,this.addValidator(o,"exclusiveMinimum",function(e){return m(e.value)||e.value>r.exclusiveMinimum})),r.hasOwnProperty("exclusiveMaximum")&&(o.templateOptions.exclusiveMaximum=r.exclusiveMaximum,this.addValidator(o,"exclusiveMaximum",function(e){return m(e.value)||e.value<r.exclusiveMaximum})),r.hasOwnProperty("multipleOf")&&(o.templateOptions.step=r.multipleOf,this.addValidator(o,"multipleOf",function(e){return m(e.value)||e.value%r.multipleOf==0}));break;case"string":["minLength","maxLength","pattern"].forEach(function(e){r.hasOwnProperty(e)&&(o.templateOptions[e]=r[e])});break;case"object":o.fieldGroup=[];var e=f(this.resolveDependencies(r),2),a=e[0],u=e[1];Object.keys(r.properties||{}).forEach(function(t){var e=i._toFieldConfig(r.properties[t],n);o.fieldGroup.push(e),e.key=t,Array.isArray(r.required)&&-1!==r.required.indexOf(t)&&(e.templateOptions.required=!0),!e.templateOptions.required&&a[t]&&(e.expressionProperties={"templateOptions.required":function(r){return r&&a[t].some(function(e){return!m(r[e])})}}),u[t]&&o.fieldGroup.push(s({},i._toFieldConfig(u[t],n),{hideExpression:function(e){return!e||m(e[t])}}))});break;case"array":o.fieldGroup=[],r.hasOwnProperty("minItems")&&(o.templateOptions.minItems=r.minItems,this.addValidator(o,"minItems",function(e){return m(e.value)||e.value.length>=r.minItems})),r.hasOwnProperty("maxItems")&&(o.templateOptions.maxItems=r.maxItems,this.addValidator(o,"maxItems",function(e){return m(e.value)||e.value.length<=r.maxItems})),Object.defineProperty(o,"fieldArray",{get:function(){if(!Array.isArray(r.items))return i._toFieldConfig(r.items,n);var e=r.items[o.fieldGroup.length]?r.items[o.fieldGroup.length]:r.additionalItems;return e?i._toFieldConfig(e,n):null},enumerable:!0,configurable:!0})}return r["enum"]&&(o.type="enum",o.templateOptions.options=r["enum"].map(function(e){return{value:e,label:e}})),r.widget&&r.widget.formlyConfig&&(o=l.ɵreverseDeepMerge(r.widget.formlyConfig,o)),n.map?n.map(o,r):o},e.prototype.resolveAllOf=function(e,i){var o=this,r=e.allOf,t=function a(e,r){var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&r.indexOf(n)<0&&(t[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var i=0;for(n=Object.getOwnPropertySymbols(e);i<n.length;i++)r.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(e,n[i])&&(t[n[i]]=e[n[i]])}return t}(e,["allOf"]);if(!r.length)throw Error("allOf array can not be empty "+r+".");return r.reduce(function(r,t){return t.$ref&&(t=o.resolveDefinition(t,i)),t.allOf&&(t=o.resolveAllOf(t,i)),r.required&&t.required&&(r.required=function n(){for(var e=[],r=0;r<arguments.length;r++)e=e.concat(f(arguments[r]));return e}(r.required,t.required)),t.uniqueItems&&(r.uniqueItems=t.uniqueItems),["maxLength","maximum","exclusiveMaximum","maxItems","maxProperties"].forEach(function(e){m(r[e])||m(t[e])||(r[e]=r[e]<t[e]?r[e]:t[e])}),["minLength","minimum","exclusiveMinimum","minItems","minProperties"].forEach(function(e){m(r[e])||m(t[e])||(r[e]=r[e]>t[e]?r[e]:t[e])}),l.ɵreverseDeepMerge(r,t)},t)},e.prototype.resolveDefinition=function(t,e){var r=f(t.$ref.split("#/"),2),n=r[0],i=r[1];if(n)throw Error("Remote schemas for "+t.$ref+" not supported yet.");var o=i?i.split("/").reduce(function(e,r){return e&&e.hasOwnProperty(r)?e[r]:null},e.schema):null;if(!o)throw Error("Cannot find a definition for "+t.$ref+".");return o.$ref?this.resolveDefinition(o,e):s({},o,["title","description","default"].reduce(function(e,r){return t.hasOwnProperty(r)&&(e[r]=t[r]),e},{}))},e.prototype.resolveDependencies=function(t){var n={},i={};return Object.keys(t.dependencies||{}).forEach(function(r){var e=t.dependencies[r];Array.isArray(e)?e.forEach(function(e){n[e]?n[e].push(r):n[e]=[r]}):i[r]=e}),[n,i]},e.prototype.guessType=function(e){var r=e.type;return!r&&e.properties?"object":r},e.prototype.addValidator=function(e,r,t){e.validators=e.validators||{},e.validators[r]=t},e.decorators=[{type:r.Injectable,args:[{providedIn:"root"}]}],e.ngInjectableDef=r.defineInjectable({factory:function(){return new e},token:e,providedIn:"root"}),e}();e.FormlyJsonschema=t,Object.defineProperty(e,"__esModule",{value:!0})});
//# sourceMappingURL=ngx-formly-core-json-schema.umd.min.js.map